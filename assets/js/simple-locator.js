jQuery(function(e){function t(t){if("."===wpsl_locator_options.mapcont.charAt(0))var o=e(t).find(wpsl_locator_options.mapcont);else var o=e(wpsl_locator_options.mapcont);return formelements={parentdiv:e(t),errordiv:e(t).find(".wpsl-error"),map:o,results:e(t).find(".wpsl-results"),distance:e(t).find(".distanceselect"),zip:e(t).find(".zipcode"),latitude:e(t).find(".latitude"),longitude:e(t).find(".longitude"),unit:e(t).find(".unit")}}function o(t){var o=e(t.zip).val();geocoder=new google.maps.Geocoder,geocoder.geocode({address:o},function(o,l){if(l==google.maps.GeocoderStatus.OK){var a=o[0].geometry.location.lat(),r=o[0].geometry.location.lng();e(t.latitude).val(a),e(t.longitude).val(r),s(t)}else e(t.errordiv).text("Address could not be found at this time.").show(),e(t.results).hide()})}function s(t){e.ajax({url:wpsl_locator.ajaxurl,type:"post",datatype:"json",data:{action:"locate",zip:e(t.zip).val(),locatorNonce:wpsl_locator.locatorNonce,distance:e(t.distance).val(),latitude:e(t.latitude).val(),longitude:e(t.longitude).val(),unit:e(t.unit).val()},success:function(o){"error"===o.status?(e(t.errordiv).text(o.message).show(),e(t.results).hide()):l(o,t)}})}function l(t,o){if(t.result_count>0){if(1===t.result_count)var s=wpsl_locator.location;else var s=wpsl_locator.locations;var l="<h3>"+t.result_count+" "+s+" "+wpsl_locator.found_within+" "+t.distance+" "+t.unit+" of "+t.zip+"</h3><ul>";for(i=0;i<t.results.length;i++){l+="<li><strong>",l=l+'<a href="'+t.results[i].permalink+'">',l+=t.results[i].title,l+="</a></strong><br />",l=l+"<em>"+wpsl_locator.distance+": "+t.results[i].distance+" "+t.unit+"</em><br />",t.results[i].address&&(l=l+t.results[i].address+"<br />"+t.results[i].city+", "+t.results[i].state+" "+t.results[i].zip);var r=t.results[i].phone,n=t.results[i].website;r&&(l=l+"<br />"+wpsl_locator.phone+": "+r),n&&(l=l+'<br /><a href="'+n+'" target="_blank">'+n+"</a>"),l+="</li>"}l+="</ul>",e(o.results).removeClass("loading").html(l),e(o.map).show(),a(t,o)}else e(o.errordiv).text("No results found.").show(),e(o.results).hide()}function a(t,o){var s,l,a,r=wpsl_locator.mapstyles,r=e.parseJSON(r),n=e(o.map)[0],i="show"===wpsl_locator_options.mapcontrols?!1:!0,u=wpsl_locator.mappin?wpsl_locator.mappin:"",d=new google.maps.LatLngBounds,p={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:r,disableDefaultUI:i},c=[],g=new google.maps.InfoWindow;s=new google.maps.Map(n,p);for(var a=0,m=t.results.length;m>a;a++){var f=t.results[a].title,v=t.results[a].latitude,w=t.results[a].longitude,h=[f,v,w];c.push(h)}for(a=0;a<c.length;a++){var _=new google.maps.LatLng(c[a][1],c[a][2]);d.extend(_),l=new google.maps.Marker({position:_,map:s,title:c[a][0],icon:u}),google.maps.event.addListener(l,"click",function(e,t){return function(){g.setContent(c[t][0]),g.open(s,e)}}(l,a)),s.fitBounds(d)}var b=google.maps.event.addListener(s,"bounds_changed",function(){google.maps.event.removeListener(b)})}e(".wpslsubmit").on("click",function(s){s.preventDefault();var l=e(this).parents(".simple-locator-form"),a=t(l);e(a.errordiv).hide(),e(a.map).hide(),e(a.results).empty().addClass("loading").show(),o(a)})});