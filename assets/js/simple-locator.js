function openInfoWindow(o){return google.maps.event.trigger(markers[o],"click"),googlemap.panTo(markers[o].getPosition()),googlemap.fitBounds(markers[o].getPosition()),googlemap.setZoom(12),!1}function wpsl_after_render(){}function wpsl_click_marker(){}function wpsl_no_results(){}function wpsl_error(){}function wpsl_success(){}var markers=[],googlemap="";jQuery(function(o){function e(e){var t=".wpsl-map",s=".wpsl-results";if("undefined"!=typeof wpsl_locator_options){if("."===wpsl_locator_options.mapcont.charAt(0))var t=o(e).find(wpsl_locator_options.mapcont);else var t=o(wpsl_locator_options.mapcont);if("."===wpsl_locator_options.resultscontainer.charAt(0))var s=o(e).find(wpsl_locator_options.resultscontainer);else var s=o(wpsl_locator_options.resultscontainer)}return formelements={parentdiv:o(e),errordiv:o(e).find(".wpsl-error"),map:t,results:s,distance:o(e).find(".distanceselect"),zip:o(e).find(".zipcode"),latitude:o(e).find(".latitude"),longitude:o(e).find(".longitude"),unit:o(e).find(".unit")}}function t(e){var t=o(e.zip).val();geocoder=new google.maps.Geocoder,geocoder.geocode({address:t},function(t,l){if(l==google.maps.GeocoderStatus.OK){var r=t[0].geometry.location.lat(),n=t[0].geometry.location.lng();o(e.latitude).val(r),o(e.longitude).val(n),s(e)}else wpsl_error("Address not found."),o(e.errordiv).text("Address not found.").show(),o(e.results).hide()})}function s(e){o.ajax({url:wpsl_locator.ajaxurl,type:"post",datatype:"json",data:{action:"locate",zip:o(e.zip).val(),locatorNonce:wpsl_locator.locatorNonce,distance:o(e.distance).val(),latitude:o(e.latitude).val(),longitude:o(e.longitude).val(),unit:o(e.unit).val()},success:function(t){console.log(t),"error"===t.status?(wpsl_error(t.message),o(e.errordiv).text(t.message).show(),o(e.results).hide()):(wpsl_success(t.result_count,t.results),l(t,e))}})}function l(e,t){if(e.result_count>0){var s=1===e.result_count?wpsl_locator.location:wpsl_locator.locations,l="<h3>"+e.result_count+" "+s+" "+wpsl_locator.found_within+" "+e.distance+" "+e.unit+" of "+e.zip+"</h3><ul>";for(i=0;i<e.results.length;i++){l=l+"<li data-result="+i+"><strong>",l=l+'<a href="'+e.results[i].permalink+'">',l+=e.results[i].title,l+="</a></strong><br />",l=l+"<em>"+wpsl_locator.distance+": "+e.results[i].distance+" "+e.unit+"</em><br />",e.results[i].address&&(l=l+e.results[i].address+"<br />"+e.results[i].city+", "+e.results[i].state+" "+e.results[i].zip);var n=e.results[i].phone,a=e.results[i].website;n&&(l=l+"<br />"+wpsl_locator.phone+": "+n),a&&(l=l+'<br /><a href="'+a+'" target="_blank">'+a+"</a>"),l+='<br /><a href="#" class="infowindow-open map-link" onClick="event.preventDefault(); openInfoWindow('+i+');">'+wpsl_locator.showonmap+"</a>",l+="</li>"}l+="</ul>",o(t.results).removeClass("loading").html(l),o(t.map).show(),o(t.zip).val("").blur(),r(e,t),wpsl_after_render()}else wpsl_no_results(e.zip),o(t.errordiv).text("No results found.").show(),o(t.results).hide()}function r(e,t){markers=[];var s=wpsl_locator.mapstyles,l=o(t.map)[0];if("undefined"!=typeof wpsl_locator_options)var r="show"===wpsl_locator_options.mapcontrols?!1:!0;else var r=!1;if("undefined"!=typeof wpsl_locator_options)var n=google.maps.ControlPosition[wpsl_locator_options.mapcontrolsposition];else var n=TOP_LEFT;var a,i,p,u=wpsl_locator.mappin?wpsl_locator.mappin:"",c=new google.maps.LatLngBounds,d={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:s,panControl:!1,disableDefaultUI:r,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL,position:n}},g=[],m=new google.maps.InfoWindow;a=new google.maps.Map(l,d);for(var p=0,f=e.results.length;f>p;p++){var w=e.results[p].title,_=e.results[p].latitude,v=e.results[p].longitude,h=e.results[p].permalink,k=[w,_,v,h];g.push(k)}for(p=0;p<g.length;p++){var y=new google.maps.LatLng(g[p][1],g[p][2]);c.extend(y),i=new google.maps.Marker({position:y,map:a,title:g[p][0],icon:u}),google.maps.event.addListener(i,"click",function(o,e){return function(){m.setContent("<h4>"+g[e][0]+'</h4><p><a href="'+g[e][3]+'">'+wpsl_locator.viewlocation+"</a></p>"),m.open(a,o),wpsl_click_marker(o,e)}}(i,p)),markers.push(i),a.fitBounds(c)}var b=google.maps.event.addListener(a,"bounds_changed",function(){google.maps.event.removeListener(b)});googlemap=a}o(".wpslsubmit").on("click",function(s){s.preventDefault();var l=o(this).parents(".simple-locator-form"),r=e(l);o(r.errordiv).hide(),o(r.map).hide(),o(r.results).empty().addClass("loading").show(),t(r)})});